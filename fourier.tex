\input{chpreamble}
  \chapter{Fourier Inversion}

    Consider the oscillation
    \begin{align*}
      \psi:\R\times\R\rightarrow\C\\
      \psi(x,\xi) = e^{2\pi i \xi x}
    \end{align*}
    As $x$ varies for a fixed $\xi$, $\psi$ is the frequency-$\xi$ oscillation on the line---a ``pure tone.''
    Just as interesting sounds are combinations of different frequencies, we can view functions as being built from these oscillations. \todo{sell this much better}

    Given a function $f:\R\rightarrow\C$, we can measure how much it ``matches'' the behavior of some frequency-$\xi$ oscillation.
    The idea is that by looking at what frequencies $f$ matches, we'll know exactly what oscillations it's built out of.
    \begin{defn}
      The \emph{frequency spectrum} or \emph{Fourier transform} of $f$ is a new function 
      \begin{align*}
        \F f&:\R\longrightarrow\C\\
        \F f(\xi) &= \int_{x\in\R} f(x)\overline\psi(x,\xi)\,dx
      \end{align*}
      Given such a frequency spectrum, we can also combine together oscillations to create a new function with the \emph{inverse Fourier transform}:
      \begin{align*}
        \F^{-1}g&:\R\longrightarrow\C\\
        \F^{-1}g(x) &= \int_{\xi\in\R} g(\xi)\psi(x,\xi)\,d\xi
      \end{align*}
      \vspace{-15pt}
    \end{defn}

    Intuitively we want to be able to say that $\F^{-1}(\F f)$ is a function that has the frequency spectrum described by $\F f$, or that $\F^{-1}\F f = f$, so the normal and inverse Fourier transforms are inverses. \todo{fix this sentence.}
    However, this claim is difficult to make because the integrals are not always defined.
    For example, $\F1(0)=\int_{-\infty}^\infty1$ is clearly non-convergent.
    In order to talk meaningfully about Fourier inversion we'll need an environment in which Fourier transforms are sensible, and so we need to limit our space of functions so that the Fourier transform works nicely.
    It is worth noting at this point that $\F^{-1}g(x) = \F g(-x)$, and so any properties of the Fourier transform extend to the inverse Fourier transform, meaning we only need consider the former.

    \section{Properties of the Fourier Transform}
%      From Fourier analysis we know the following properties of the Fourier transform: \todo{where?}
%      \begin{itemize}
%        \item The smoother $f$ is the faster $\F f$ decays.
%          If $f$ has integrable derivatives of order up to $k$, then $\F f(x)$ decays at least as quickly as $|x|^{-k}$ as $x$ approaches $\infty$.
%        \item The faster $f$ decays the smoother $\F f$ is.
%  
%          If $f$ decays at least as quickly as $|x^{-k}|$ as $x\rightarrow\infty$, then $\F f$ has integrable derivatives of order up to $k-2$. % when dom f = \R^n this is k-n-1
%      \end{itemize}

      Before we develop a space of functions on which the Fourier transform is well-behaved, it is helpful to have an idea of how the Fourier transform acts.
      First we define some notation:
      \begin{defn}
        For any $x\in\R$ define:
        \begin{itemize}
          \item the frequency-$x$ oscillation $\psi_x$:
            \begin{equation*}
              \psi_x:\R\rightarrow\C,\ \psi_x(\xi) = \psi(x,\xi) = e^{2\pi i x \xi}
            \end{equation*}
          \item the translation operator $T_x$ on functions $f:\R\rightarrow\C$:
            \begin{equation*}
              (T_xf)(y) = f(x+y)
            \end{equation*}
%          \item the dilation $f_x$ for a function $f:\R\rightarrow\C$:
%            \begin{equation*}
%              (f_x)(y) = f(xy)
%            \end{equation*}
        \end{itemize}
      \end{defn}
      The following lemma gives identities that can be computed directly from definition with moderate conditions on the functions considered.
      \begin{lemma}
        \label{lemma:fourprops}
%        Let $a,b\in\R$ and take $f,g:\R\rightarrow\C$ to be piecewise continuous and integrable, which guarantees that their Fourier transforms are always convergent\footnotemark (although they need not be continuous or integrable). 
%        \footnotetext{See that $|\psi(x,\xi)|=1$ so for integrable $f$ the integral $\F f$ will be absolutely convergent, and thus it will converge in \R.}
        Let $a,b\in\R$ and take $f,g:\R\rightarrow\C$.
        Then, working purely formally (that is, assuming all integrals are well behaved):
        \begin{align}
          \F(af + bg) &= a\F f + b\F g\\
          \label{eq:tsltisphi}
            T_x\F^{-1}f &= \F^{-1}(\psi_xf)\\
          \label{eq:tsltisphi2}
          \psi_x\F f &= \F(T_xf)\\
          \label{eq:xisdiff}
            \F(xf) &= -\frac{1}{2\pi i}(\F f)'\\
          \label{eq:xisdiff2}
            \F(f') &= -2\pi ix\F f
%          \F(f_x) &= \frac{1}{|x|}(\F f)_{x^{-1}}
        \end{align}
        \begin{proof}[Proof of \eqref{eq:tsltisphi}]
          \begin{align*}
            (T_x\F^{-1}f)(y) &= (\F^{-1}f)(x+y)\\
            &= \int_{\xi\in\R}f(\xi)e^{2\pi i(x+y)\xi}\,d\xi\\
            &= \int_{\xi\in\R}f(\xi)\psi_x(\xi)\psi(y,\xi)\,d\xi\\
            &= \F^{-1}(\psi_xf)(y)
          \end{align*}
        \end{proof}
        \begin{proof}[Proof of \eqref{eq:xisdiff}]
          \begin{align*}
            (\F f)'(\xi) &= \frac{d}{d\xi}\int_{x\in\R} f(x)e^{-2\pi i x\xi}\,dx\\
            &= -2\pi i \int_{x\in\R} xf(x)e^{2\pi i x\xi}\,dx\\
            &= -2\pi i\F(xf)(\xi)
          \end{align*}
        \end{proof}
      \end{lemma}
      This result demonstrates the key properties of the Fourier transform:
      \begin{itemize}
        \item It is linear;
        \item It exchanges translation and multiplication by an oscillation;
        \item It exchanges multiplication by $x$ and differentiation.
      \end{itemize}

    \section{Schwartz Functions}
      We hope to use \thref{lemma:fourprops} to find a space of functions that is closed under the Fourier transform, and so we may take Fourier transforms without concern.
      Noting that $|\psi(x,\xi)|=1$ for all $x$ and $\xi$, we can see that the integral $\int_\xi f(\xi)\psi(x,\xi)$ will converge absolutely (and so will converge in \R) whenever $f$ \emph{vanishes at infinity}---that is, for any $\varepsilon>0$ there exists $N>0$ such that
      \begin{equation*}
        |x|>N \Rightarrow f(x)<\epsilon
      \end{equation*}
      Thus the Fourier transform is always defined for functions that vanish at infinity.

      Using \eqref{eq:xisdiff} and \eqref{eq:xisdiff2} we can observe that the Fourier transform exchanges (up to a constant) multiplication by $x$ with differentiation. 
      Because it's useful (\todo{reference diffeq example, once its written}) we want to allow differentiation of any functions.
      This leaves us with the following requirements on our space of functions:
      \begin{enumerate}[label=(\alph*)]
        \item \label{i:vanish}Every function vanishes at infinity;
        \item \label{i:diff}It is closed under differentiation;
        \item \label{i:mult}It is closed under multiplication by $x$.
      \end{enumerate}
      We call such functions \emph{Schwartz functions}:

%      Now suppose that $f$ is such a function.
%      By \ref{i:diff} $f$ will be infinitely differentiable.
%      For any $k,\ell\ge0$, we see from \ref{i:vanish} and \ref{i:mult} that $x^kf^{(\ell)}$ will vanish at infinity.

      \begin{defn}
        A Schwartz function is a function
        \begin{equation*}
          \varphi:\R\rightarrow\C
        \end{equation*}
        that is infinitely differentiable, and for any $k\ge0$ the derivative $\varphi^{(k)}$ decays faster than any power of $x$:
        \begin{equation*}
          \forall d,k\ge0\ \ x^d\varphi^{(k)}(x)\text{ vanishes at infinity}
        \end{equation*}

        The set of all Schwartz functions is denoted \S.
      \end{defn}

      It is verifiable that \S is the largest possible space satisfying the requirements above.
      However, because we made no reference to the Fourier transform in our definition, the following bears proof:

      \begin{lemma}
        \label{lemma:sclosed}
        Let $f\in\S$.
        Then $\F f\in\S$.
        \begin{proof}
          First, we can clearly see that $\F f$ is defined due to the decay condition on $f$.

          Now we wish to show that $\F f$ meets the decay condition for Schwartz functions.
          Applying integration by parts:
          \begin{align*}
            \xi^k\F f(\xi) &= \int_{x\in\R} f(x)\xi^ke^{-2\pi ix\xi}\,dx\\
            &= \left.f(x)\cdot\frac{\xi^{k-1}e^{-2\pi i x\xi}}{-2\pi i}\right|_{-\infty}^\infty - \frac{1}{-2\pi i}\int_{x\in\R} f'(x)\xi^{k-1}e^{-2\pi ix\xi}\,dx
          \end{align*}
          Because $f$ is Schwartz, the left hand summand is clearly zero.
          Repeating this process $k$ times yields:
          \begin{align*}
            \xi^k\F f(\xi) &= \left(\frac{1}{2\pi i}\right)^k \int_{x\in\R}f^{(k)}(x)\psi(x,\xi)\,dx
          \end{align*}
          By definition $f^{(k)}$ is Schwartz, so we can apply the Riemann-Lebesgue Lemma because our decay conditions ensure that it will be integrable.
          Thus $\lim_{|\xi|\rightarrow\infty} \xi^k\F f(\xi) = 0$, which is exactly the decay condition on Schwartz functions.

          Now we must show that $\F f$ is differentiable. 
          By \eqref{eq:xisdiff} we see
          \begin{align*}
            (\F f)'(\xi) &= -2\pi i \F(\xi f)(\xi)
          \end{align*}
          Because $\xi f$ is Schwartz by definition, we can see (from above) that $\F(\xi f)$, and thus $(\F f)'$, will decay faster than any power of $\xi$.
          Repeated applications of \eqref{eq:xisdiff} will show this for all derivatives of $\F f$, and thus $\F f$ is Schwartz.
        \end{proof}
      \end{lemma}
%      Because of the decay condition on Schwartz functions their Fourier transform will \emph{always} be defined -- the integral will never diverge, so we can always talk about Fourier transforms of Schwartz functions.
%
%      Using our facts about the Fourier transform we can see that for $f\in\S$:
%      \todo{update this to reflect our different presentation of \S}
%      \begin{itemize}
%        \item $\F f$ decays faster than any power of $x$ because $f$ has infinitely many continuous derivatives.
%        \item $\F f$ has infinitely many derivatives because $f$ decays faster than any power of $x$.
%      \end{itemize}
%      Thus $\F f$ is a Schwartz function, and so, because $f(-x)$ is also Schwartz, $\F^{-1}f$ is \emph{also} Schwartz.

    \section{Fourier Inversion}
      Now that we have an appropriate environment, we can properly investigate the relationship we want to find between the normal and inverse Fourier transforms.
      \begin{thm}[Fourier Inversion on \S]
        \label{thm:fourinv}
        Let $\varphi$ be a Schwartz function.
        Then \[\F^{-1}\F \varphi = \varphi\text{.}\]
      \end{thm}
      To prove \thref{thm:fourinv} we first reduce it to the single case of $x=0$:
      \begin{claim}[Fourier inversion, granting inversion at 0]
        Suppose that for all $\phi\in\S$, $(\F^{-1}\F\phi)(0) = \phi(0)$.
        Then for all $\varphi\in\S$ and $x\in\R$, $(\F^{-1}\F\varphi)(x)=\varphi(x)$.
        \begin{proof}
          \begin{align*}
            (\F^{-1}\F\varphi)(x) &= (T_x\F^{-1}\F\varphi)(0) &\text{by defn. of $T_x$}\\
            &= (\F^{-1}(\psi_x\F\varphi))(0) &\text{by \eqref{eq:tsltisphi}}\\
            &= (\F^{-1}\F T_x\varphi)(0)  &\text{by \eqref{eq:tsltisphi2}}\\
            &= (T_x\varphi)(0) &\text{by hypothesis}\\
            &= \varphi(x)
          \end{align*}
        \end{proof}
      \end{claim}
      Thus we only need to show inversion at zero.

      \begin{rmk}
        The proof given here, while fairly simple, only applies to the 1-dimensional case. \todo{The proof for Euclidean space}
      \end{rmk}
      \begin{proof}[Proof of \thref{thm:fourinv}]
        We first reduce the problem further, using a tricky function:
        Recall that the \emph{Gaussian} function $\gamma:\R\rightarrow\R$ given by $\gamma(x) = e^{-\pi x^2}$ has $\gamma=\F\gamma=\F^{-1}\gamma$, and that (clearly) $\gamma(0)=1$.
        Then 
        \begin{align*}
          (\F^{-1}\F\varphi)(0) - \varphi(0) &= (\F^{-1}\F\varphi)(0) - (\varphi(0)\gamma)(0)\\
          &= (\F^{-1}\F\varphi - \varphi(0)\gamma)(0)\\
          &= (\F^{-1}\F\varphi - \varphi(0)(\F^{-1}\F\gamma))(0)\\
          &= \F^{-1}\F(\varphi-\varphi(0)\gamma)(0)
        \end{align*}
        using the linearity of $\F$ and $\F^{-1}$.
        Thus, because $(\varphi-\varphi(0)\gamma)(0)=0$, we need only show that $(\F^{-1}\F\phi)(0) = 0$ whenever $\phi(0)=0$.

        Having reduced the problem of Fourier inversion to the case where $x=0$ and our Schwartz function vanishes at zero, we suppose that $\phi\in\S$ satisfies $\phi(0)=0$. 
        Then for $x\ne0$:
        \begin{equation*}
          \frac{\phi(x)}{x} = \frac{\phi(x)-\phi(0)}{x} = \int_{t=0}^1 \phi'(xt)dt
        \end{equation*}
        Call this integral $\varphi$.
        We can easily calculate that $\varphi^{(k)}(x) = \int_0^1t^k\phi^{(k+1)}(xt)\,dt$, and so $\varphi$ and its derivatives will be smooth for all $x$ and will inherit rapid decay from $\phi$.
        Thus $\varphi\in\S$.

        By \eqref{eq:xisdiff}:
        \begin{equation*}
          (\F\phi)(\xi) = (\F x\varphi)(\xi)= -\frac{1}{2\pi i}(\F\varphi)'(\xi)
        \end{equation*}
        This equality allows us to calculate:
        \begin{equation*}
          (\F^{-1}\F\phi)(0) = \int_{\xi\in\R} \F\phi(\xi)d\xi = -\frac{1}{2\pi i}\int_{\xi\in\R} (\F\varphi)'(\xi)d\xi = -\frac{1}{2\pi i} \F\varphi\vert_{-\infty}^\infty = 0
        \end{equation*}
        thus proving Fourier inversion on \S.
      \end{proof}

    \section{Tempered Distributions}
      We now consider Fourier inversion in the context of the \emph{continuous linear dual} of \S:
      \begin{equation*}
        \S^* = \{f:\S\rightarrow\C\,\vert\,f\text{ is continuous and linear}\}
      \end{equation*}
      We call $\S^*$ the space of \emph{tempered distributions}.
      This space is not, by itself, interesting, but note the inclusion:
      \begin{equation*}
        \S\rightarrow\S^*\text{ by }\varphi \longmapsto\left(\phi\mapsto\int_{x\in\R}\varphi(x)\phi(x)dx\right)
      \end{equation*}
      This inclusion allows us to define the Fourier transform for tempered distributions by adjoint-like characterization:
      \begin{equation*}
        \langle\F f,\varphi\rangle = \langle f,\F\varphi\rangle \text{ for }f,\varphi\in\S^*
      \end{equation*}
      because for $f,\varphi\in\S$:
      \begin{align*}
        \langle\F f,\varphi\rangle &= \int_\xi\F f(\xi)\varphi(\xi)\,d\xi\\
        &= \int_\xi\int_xf(x)\psi(x,\xi)\,dx\,\varphi(\xi)\,d\xi\\
        &= \int_xf(x)\int_\xi\varphi(\xi)\psi(x,\xi)\,d\xi dx\\
        &= \langle f,\F\varphi\rangle
      \end{align*}

    \section{A Topological View of \S}

    \section{The Topology of Tempered Distributions}
\end{document}

\input{chpreamble}
  \chapter{Fourier Inversion}

    Consider the oscillation
    \begin{align*}
      \psi:\R\times\R\longrightarrow\C\\
      \psi(x,\xi) = e^{2\pi i \xi x}
    \end{align*}
    As $x$ varies for a fixed $\xi$, $\psi$ is the frequency-$\xi$ oscillation on the line---a ``pure tone.''
    Just as interesting sounds are combinations of different frequencies, we can view functions as being built from these oscillations. \todo{sell this much better}

    Given a function $f:\R\rightarrow\C$, we can measure how much it ``matches'' the behavior of some frequency-$\xi$ oscillation.
    The idea is that by looking at what frequencies $f$ matches, we'll know exactly what oscillations it's built out of.
    \begin{defn}
      The \emph{frequency spectrum} or \emph{Fourier transform} of $f$ is a new function 
      \begin{align*}
        \F f&:\R\longrightarrow\C\\
        \F f(\xi) &= \int_{x\in\R} f(x)\overline\psi(x,\xi)\,dx
      \end{align*}
      Given such a frequency spectrum, we can also combine together oscillations to create a new function with the \emph{inverse Fourier transform}:
      \begin{align*}
        \F^{-1}g&:\R\longrightarrow\C\\
        \F^{-1}g(x) &= \int_{\xi\in\R} g(\xi)\psi(x,\xi)\,d\xi
      \end{align*}
      \vspace{-15pt}
    \end{defn}

    Intuitively we want to be able to say that $\F^{-1}(\F f)$ is a function that has the frequency spectrum described by $\F f$, or that $\F^{-1}\F f = f$, so the normal and inverse Fourier transforms are inverses. \todo{fix this sentence.}
    However, this claim is difficult to make because the integrals are not always defined.
    For example, $\F1(0)=\int_{-\infty}^\infty1$ is clearly non-convergent.
    In order to talk meaningfully about Fourier inversion we'll need an environment in which Fourier transforms are sensible, and so we need to limit our space of functions so that the Fourier transform works nicely.
    It is worth noting at this point that $\F^{-1}g(x) = \F g(-x)$, and so any properties of the Fourier transform extend to the inverse Fourier transform, meaning we only need consider the former.

    \section{Properties of the Fourier Transform}
%      From Fourier analysis we know the following properties of the Fourier transform: \todo{where?}
%      \begin{itemize}
%        \item The smoother $f$ is the faster $\F f$ decays.
%          If $f$ has integrable derivatives of order up to $k$, then $\F f(x)$ decays at least as quickly as $|x|^{-k}$ as $x$ approaches $\infty$.
%        \item The faster $f$ decays the smoother $\F f$ is.
%  
%          If $f$ decays at least as quickly as $|x^{-k}|$ as $x\rightarrow\infty$, then $\F f$ has integrable derivatives of order up to $k-2$. % when dom f = \R^n this is k-n-1
%      \end{itemize}

      Before we develop a space of functions on which the Fourier transform is well-behaved, it is helpful to have an idea of how the Fourier transform acts.
      First we define some notation:
      \begin{defn}
        For any $x\in\R$ define:
        \begin{itemize}
          \item the frequency-$x$ oscillation $\psi_x$:
            \begin{align*}
              \psi_x:\R\rightarrow\C,\ \psi_x(\xi) = \psi(x,\xi) = e^{2\pi i x \xi}
            \end{align*}
          \item the translation operator $T_x$ on functions $f:\R\rightarrow\C$:
            \begin{align*}
              (T_xf)(y) = f(x+y)
            \end{align*}
%          \item the dilation $f_x$ for a function $f:\R\rightarrow\C$:
%            \begin{align*}
%              (f_x)(y) = f(xy)
%            \end{align*}
        \end{itemize}
      \end{defn}
      The following lemma gives identities that can be computed directly from definition with moderate conditions on the functions considered.
      \begin{lemma}
        \label{lemma:fourprops}
%        Let $a,b\in\R$ and take $f,g:\R\rightarrow\C$ to be piecewise continuous and integrable, which guarantees that their Fourier transforms are always convergent\footnotemark (although they need not be continuous or integrable). 
%        \footnotetext{See that $|\psi(x,\xi)|=1$ so for integrable $f$ the integral $\F f$ will be absolutely convergent, and thus it will converge in \R.}
        Let $a,b\in\R$ and take $f,g:\R\rightarrow\C$.
        Then, working purely formally (that is, assuming all integrals are well behaved):
        \begin{align}
          \F(af + bg) &= a\F f + b\F g\\
          \label{eq:tsltispsi}
            T_x\F^{-1}f &= \F^{-1}(\psi_xf)\\
          \label{eq:tsltispsi2}
          \psi_x\F f &= \F(T_xf)\\
          \label{eq:xisdiff}
            \F(xf) &= -\frac{1}{2\pi i}(\F f)'\\
          \label{eq:xisdiff2}
            \F(f') &= -2\pi i\xi\F f
%          \F(f_x) &= \frac{1}{|x|}(\F f)_{x^{-1}}
        \end{align}
        \begin{proof}[Proof of \eqref{eq:tsltispsi}]
          \begin{align*}
            (T_x\F^{-1}f)(y) &= (\F^{-1}f)(x+y)\\
            &= \int_{\xi\in\R}f(\xi)e^{2\pi i(x+y)\xi}\,d\xi\\
            &= \int_{\xi\in\R}f(\xi)\psi_x(\xi)\psi(y,\xi)\,d\xi\\
            &= \F^{-1}(\psi_xf)(y)
          \end{align*}
        \end{proof}
        \begin{proof}[Proof of \eqref{eq:xisdiff}]
          \begin{align*}
            (\F f)'(\xi) &= \frac{d}{d\xi}\int_{x\in\R} f(x)e^{-2\pi i x\xi}\,dx\\
            &= -2\pi i \int_{x\in\R} xf(x)e^{2\pi i x\xi}\,dx\\
            &= -2\pi i\F(xf)(\xi)
          \end{align*}
        \end{proof}
      \end{lemma}
      This result demonstrates the key properties of the Fourier transform:
      \begin{itemize}
        \item It is linear;
        \item It exchanges translation and multiplication by an oscillation;
        \item It exchanges multiplication by $x$ and differentiation.
      \end{itemize}

      These properties make the Fourier transform useful for solving real-world problems.
      \begin{example}[The heat equation]
        \label{ex:heateq}
        Consider a long metal wire whose temperature distribution at time $t=0$ is given by a function $f(x)$.
        We would like to describe the temperature distribution on the wire as time passes.
        If we write the temperature of a point $x$ on the wire at time $t>0$ as $u(x,t)$, by the \emph{heat equation} from physics we have that
        \begin{align*}
          \frac{\partial}{\partial t}u(x,t) &= \alpha\frac{\partial^2}{\partial x^2}u(x,t)
        \end{align*}
        for some $\alpha$ in \R that depends on the properties of our wire. 
        Noting that the Fourier transform exchanges differentiation and multiplication by a variable, we take the Fourier transform of our differential equation with respect to the $x$ parameter.
        \begin{align*}
          \F_x\left(\frac{\partial}{\partial t}u(x,t)\right) &= \F_x\left(\alpha\frac{\partial^2}{\partial x^2}u(x,t)\right)\\
          \frac{\partial}{\partial t}\F_xu(\xi,t) &= -k\xi^2\F_xu(\xi,t)
        \end{align*}
        folding $\alpha$ and the constants of \eqref{eq:xisdiff2} into $k$.
        \todo{double check that passing the derivative through is fine if $u$ is nice.}
        The initial condition $u(x,0)=f(x)$ is transformed to $\F_xu(\xi,0) = \F f(\xi)$.
        
        Note that these transformations have made the differential equation easier to solve, by replacing $x$ derivatives with multiples of $\xi$.
        Solving yields
        \begin{align*}
          \F_xu(\xi,t) &= c(\xi)e^{-k\xi^2t}
        \end{align*}
        for some function $c$.
        Our initial condition gives $c(\xi)=\F f(\xi)$, and so
        \begin{align*}
          u(x,t) &= \F^{-1}(e^{-k\xi^2t}\F f(\xi))\\
          &= \int_{\xi\in\R} \F f(\xi)e^{-k\xi^2t}\psi(x,\xi)\,d\xi\\
          &= \int_{\xi\in\R} \int_{y\in\R} f(y)\psi(y,\xi)\,dy\,e^{-k\xi^2t}\psi(x,\xi)\,d\xi\\
          &= \int_{y\in\R} f(y) \int_{\xi\in\R} e^{-k\xi^2t}\psi(x+y,\xi)\,d\xi\,dy\\
          &= \frac{1}{\sqrt{4\pi kt}}\int_{y\in\R} f(y)e^{-(x-y)^2/4kt}\,dy
        \end{align*}
        which is verifiably a solution to the heat equation.

        \todo{more discussion}
        \begin{figure}
          \begin{center}
            \begin{sagesilent}
              x,y,t=var('x,y,t')
              gamma(x,t) = e^(-(x^2)/t)
              f(x)=(sgn(x)*sgn(1-x))
              assume(t>0)
              u(x,t) = (1/sqrt(t))*(integral(f(y)*gamma(x-y,t),y,-Infinity,0)+integral(f(y)*gamma(x-y,t),y,0,1)+integral(f(y)*gamma(x-y,t),y,1,Infinity))
            \end{sagesilent}
            \sageplot{reduce(lambda x,y: x+y,[plot(u(x,t),x,(-1,2),color=c,legend_label='$t='+str(t)+'$',axes=false) for t,c in [(1/1000,(0,0,0)), (1/8,(.2,.2,.2)), (1/4,(.4,.4,.4)), (1/2,(.5,.5,.5)), (1,(.6,.6,.6)), (2,(.7,.7,.7))]])}
          \end{center}
          \caption{An example solution to the heat equation for a square pulse of heat, calculated from the function $u(x,t)$ derived in Example \ref*{ex:heateq}}
          \label{fig:heateq}
        \end{figure}
        An example of this solution is shown in \autoref{fig:heateq}.
      \end{example}

    \section{Schwartz Functions}
      We hope to use \thref{lemma:fourprops} to find a space of functions that is closed under the Fourier transform, and so we may take Fourier transforms without concern, as we will always understand the result.

      Noting that $|\psi(x,\xi)|=1$ for all $x$ and $\xi$, we can see that the integral $\int_\xi f(\xi)\psi(x,\xi)$ will converge absolutely (and so will converge in \R) whenever $f$ \emph{vanishes at infinity}---that is, for any $\varepsilon>0$ there exists $N>0$ such that
      \begin{align*}
        |x|>N \Rightarrow f(x)<\epsilon
      \end{align*}
      Thus the Fourier transform is always defined for functions that vanish at infinity.

      We also observed in \thref{ex:heateq} that the Fourier transform is useful because of its ability to exchange differentiation and multiplication.
      To make use of this fact, we also want our space to be closed when we take derivatives or multiply by $x$.
      This leaves us with the following requirements on our space of functions:
      \begin{enumerate}[label=(\alph*)]
        \item \label{i:vanish}Every function vanishes at infinity;
        \item \label{i:diff}It is closed under differentiation;
        \item \label{i:mult}It is closed under multiplication by $x$.
      \end{enumerate}
      We call such functions \emph{Schwartz functions}:

%      Now suppose that $f$ is such a function.
%      By \ref{i:diff} $f$ will be infinitely differentiable.
%      For any $k,\ell\ge0$, we see from \ref{i:vanish} and \ref{i:mult} that $x^kf^{(\ell)}$ will vanish at infinity.

      \begin{defn}
        A Schwartz function is a function
        \begin{align*}
          \varphi:\R\rightarrow\C
        \end{align*}
        that is infinitely differentiable and is \emph{rapidly decaying}.
        That is, for any $k\ge0$, the derivative $\varphi^{(k)}$ decays faster than any power of $x$:
        \begin{align*}
          \forall d,k\ge0\ \ x^d\varphi^{(k)}(x)\text{ vanishes at infinity}
        \end{align*}
        The set of all Schwartz functions is denoted \S.
      \end{defn}

      It is verifiable that \S is:
      \begin{itemize}
        \item the largest possible space satisfying the requirements above;
        \item a vectorspace over \C---that is, closed under addition and multiplication by complex numbers;
        \item closed under translation and multiplication by an oscillation;
        \item closed under differentiation and multiplication by $x$.
      \end{itemize}

      Because we made no reference to the Fourier transform in our definition of \S, the following bears proof:

      \begin{lemma}[Closure of \S under \F]
        \label{lemma:sclosed}
        Let $f\in\S$.
        Then $\F f\in\S$.
        \begin{proof}
          First, we can clearly see that $\F f$ is defined due to the decay condition on $f$.

          Now we wish to show that $\F f$ meets the decay condition for Schwartz functions.
          Applying integration by parts:
          \begin{align*}
            \xi^k\F f(\xi) &= \int_{x\in\R} f(x)\xi^ke^{-2\pi ix\xi}\,dx\\
            &= \left.f(x)\cdot\frac{\xi^{k-1}e^{-2\pi i x\xi}}{-2\pi i}\right|_{-\infty}^\infty - \frac{1}{-2\pi i}\int_{x\in\R} f'(x)\xi^{k-1}e^{-2\pi ix\xi}\,dx
          \end{align*}
          Because $f$ is Schwartz, the left hand summand is clearly zero.
          Repeating this process $k$ times yields:
          \begin{align*}
            \xi^k\F f(\xi) &= \left(\frac{1}{2\pi i}\right)^k \int_{x\in\R}f^{(k)}(x)\psi(x,\xi)\,dx
          \end{align*}
          By definition $f^{(k)}$ is Schwartz, so we can apply the Riemann-Lebesgue Lemma because our decay conditions ensure that it will be integrable.
          Thus $\lim_{|\xi|\rightarrow\infty} \xi^k\F f(\xi) = 0$, which is exactly the decay condition on Schwartz functions.

          Now we must show that $\F f$ is differentiable. 
          By \eqref{eq:xisdiff} we see
          \begin{align*}
            (\F f)'(\xi) &= -2\pi i \F(\xi f)(\xi)
          \end{align*}
          Because $\xi f$ is Schwartz by definition, we can see (from above) that $\F f$ is differentiable.
          In fact, $\F(\xi f)$, and thus $(\F f)'$, will decay faster than any power of $\xi$.
          Repeated applications of \eqref{eq:xisdiff} will show this for all derivatives of $\F f$, and thus $\F f$ is Schwartz.
        \end{proof}
      \end{lemma}
      \begin{rmk}
        The proof of \thref{lemma:sclosed} relies on the (near-)symmetry of the Fourier transform with respect to differentiation and multiplication by $x$:
        \begin{itemize}
          \item $\F f$ decays faster than any power of $x$ because $f$ has infinitely many derivatives.
          \item $\F f$ has infinitely many derivatives because $f$ decays faster than any power of~$x$.
        \end{itemize}
      \end{rmk}

    \section{Fourier Inversion}
      Now that we have an appropriate environment, we can properly investigate the relationship we want to find between the normal and inverse Fourier transforms.
      \begin{thm}[Fourier Inversion on \S]
        \label{thm:fourinv}
        Let $\varphi$ be a Schwartz function.
        Then \[\F^{-1}\F \varphi = \varphi\text{.}\]
      \end{thm}
      To prove \thref{thm:fourinv} we first reduce it to the single case of $x=0$:
      \begin{claim}[Fourier inversion, granting inversion at 0]
        Suppose that for all $\phi\in\S$, $(\F^{-1}\F\phi)(0) = \phi(0)$.
        Then for all $\varphi\in\S$ and $x\in\R$, $(\F^{-1}\F\varphi)(x)=\varphi(x)$.
        \begin{proof}
          \begin{align*}
            (\F^{-1}\F\varphi)(x) &= (T_x\F^{-1}\F\varphi)(0) &\text{by defn. of $T_x$}\\
            &= (\F^{-1}(\psi_x\F\varphi))(0) &\text{by \eqref{eq:tsltispsi}}\\
            &= (\F^{-1}\F T_x\varphi)(0)  &\text{by \eqref{eq:tsltispsi2}}\\
            &= (T_x\varphi)(0) &\text{by hypothesis}\\
            &= \varphi(x)
          \end{align*}
        \end{proof}
      \end{claim}
      Thus we only need to show inversion at zero.

      \begin{rmk}
        The proof given here, while fairly simple, only applies to the 1-dimensional case. \todo{The proof for Euclidean space}
      \end{rmk}
      \begin{proof}[Proof of \thref{thm:fourinv}]
        We first reduce the problem further, using a tricky function:
        Recall that the \emph{Gaussian} function $\gamma:\R\rightarrow\R$ given by $\gamma(x) = e^{-\pi x^2}$ has $\gamma=\F\gamma=\F^{-1}\gamma$, and that (clearly) $\gamma(0)=1$.
        Then 
        \begin{align*}
          (\F^{-1}\F\varphi)(0) - \varphi(0) &= (\F^{-1}\F\varphi)(0) - (\varphi(0)\gamma)(0)\\
          &= (\F^{-1}\F\varphi - \varphi(0)\gamma)(0)\\
          &= (\F^{-1}\F\varphi - \varphi(0)(\F^{-1}\F\gamma))(0)\\
          &= \F^{-1}\F(\varphi-\varphi(0)\gamma)(0)
        \end{align*}
        using the linearity of $\F$ and $\F^{-1}$.
        Thus, because $(\varphi-\varphi(0)\gamma)(0)=0$, we need only show that $(\F^{-1}\F\phi)(0) = 0$ whenever $\phi(0)=0$.

        Having reduced the problem of Fourier inversion to the case where $x=0$ and our Schwartz function vanishes at zero, we suppose that $\phi\in\S$ satisfies $\phi(0)=0$. 
        Then for $x\ne0$:
        \begin{align*}
          \frac{\phi(x)}{x} = \frac{\phi(x)-\phi(0)}{x} = \int_{t=0}^1 \phi'(xt)dt
        \end{align*}
        Call this integral $\varphi$.
        We can easily calculate that $\varphi^{(k)}(x) = \int_0^1t^k\phi^{(k+1)}(xt)\,dt$, and so $\varphi$ and its derivatives will be smooth for all $x$ and will inherit rapid decay from $\phi$.
        Thus $\varphi\in\S$.

        By \eqref{eq:xisdiff}:
        \begin{align*}
          (\F\phi)(\xi) = (\F x\varphi)(\xi)= -\frac{1}{2\pi i}(\F\varphi)'(\xi)
        \end{align*}
        This equality allows us to calculate:
        \begin{align*}
          (\F^{-1}\F\phi)(0) = \int_{\xi\in\R} \F\phi(\xi)d\xi = -\frac{1}{2\pi i}\int_{\xi\in\R} (\F\varphi)'(\xi)d\xi = -\frac{1}{2\pi i} \F\varphi\vert_{-\infty}^\infty = 0
        \end{align*}
        thus proving Fourier inversion on \S.
      \end{proof}

    \section{Tempered Distributions}
      We now want to consider Fourier inversion in the context of the \emph{continuous linear dual} of \S:
      \begin{align*}
        \S^* = \{f:\S\rightarrow\C\,\vert\,f\text{ is continuous and linear}\}
      \end{align*}
      We call $\S^*$ the space of \emph{tempered distributions}.

      Note that we have not yet defined a notion of topology on \S, and so have no notion of continuity of functionals on \S, and so this definition is not yet exact.
      We will introduce a topology on \S in \autoref{ch:topons}; until then we will not rely on topological notions.

      In general, the space \S is not interesting, but note the inclusion:
      \begin{align*}
        \S\rightarrow\S^*\text{ by }\varphi \longmapsto\left(\phi\mapsto\int_{x\in\R}\varphi(x)\phi(x)dx\right)
      \end{align*}
      We will show that for any $\varphi$ this functional is continuous once we define a topology on $\S^*$. \todo{maybe handle this a little better}
      
      The inclusion allows us to define the Fourier transform for tempered distributions.
      For $f$ and $\varphi$ in \S, treat $f$ as a distribution:
      \begin{align*}
        \langle\F f,\varphi\rangle &= \int_\xi\F f(\xi)\varphi(\xi)\,d\xi\\
        &= \int_\xi\int_xf(x)\psi(x,\xi)\,dx\,\varphi(\xi)\,d\xi\\
        &= \int_xf(x)\int_\xi\varphi(\xi)\psi(x,\xi)\,d\xi dx\\
        &= \langle f,\F\varphi\rangle
      \end{align*}
      We thus \emph{define} the Fourier transform of a \emph{general} $f\in\S^*$ by the adjoint-like characterization:
      \begin{align*}
        \langle\F f,\varphi\rangle = \langle f,\F\varphi\rangle \text{ for }f\in\S^*\text{ and }\varphi\in\S
      \end{align*}
      We similarly define the inverse Fourier transform for $f\in\S^*$:
      \begin{align*}
        \langle\F^{-1}f,\varphi\rangle = \langle f,\F^{-1}\varphi\rangle\text{ for }\varphi\in\S
      \end{align*}
      The key point is that these definitions are \emph{consistent} with our viewing Schwartz functions as tempered distributions---in fact, it is the only such way to define the Fourier transform on~$\S^*$.

      We would now like to show that the Fourier Transform on $\S^*$ behaves as nicely as it does on \S.
      Because we chose our definition to be consistent with viewing Schwartz functions as tempered distributions, much of this nice behaviour is inherited.
      For example, the following result is basic, thanks to our definition.
%      Having defined the Fourier transform on tempered distributions, we hope to show that it behaves nicely.
%      Happily, our definition allows it to inherit its behavior from its action on Schwartz functions.
%      This is demonstrated by the ease of proving Fourier inversion:
      \begin{thm}[Fourier Inversion on $\S^*$]
        \label{thm:fourinv_td}
        Let $\varphi\in\S^*$.
        Then
        \begin{align*}
          \F^{-1}\F\varphi &= \varphi
        \end{align*}
      \end{thm}
      \begin{proof}[Proof of \thref{thm:fourinv_td}]
        For $\phi\in\S$:
        \begin{align*}
          \langle\F^{-1}\F\varphi, \phi\rangle &= \langle \F\varphi, \F^{-1}\phi\rangle\\
          &= \langle\varphi, \F\F^{-1}\phi\rangle\\
          &= \langle\varphi, \phi\rangle
        \end{align*}
      \end{proof}

      In fact, similar (although admittedly less straightforward) proofs show all of the identities of \thref{lemma:fourprops} for tempered distributions.
      However, this undertaking also requires us to clarify just what is meant by the derivative of a tempered distribution, or multiplying a distribution by $x$.
      We will revisit these ideas when we have a more powerful set of (topological) tools at our disposal.
      We hope that by more closely examining \S and $\S^*$ we can discover what the answers \emph{must} be.

      \todo{give an example of tempered distributions being useful at this level of understanding}
\end{document}

\input{chpreamble}
  \setcounter{chapter}{2}
  \setcounter{thm}{0}
  \chapter{Distributions}
  \label{ch:dist}
  
  With a firm grasp of the topology of \S, we now turn back to topological issues.
  Recall from \cref{sec:tempdist} that continuous linear dual of \S is the space of \emph{tempered distributions}:
  \begin{align*}
    \S^* = \{f:\S\rightarrow\C\,\vert\,f\text{ is continuous and linear}\}
  \end{align*}
  This definition is now fully sensible, as we know what it means to be a continuous functional on \S.
  Recall the mapping taking a test function $\varphi$ to the integration-against-$\varphi$ functional on \S:
  \begin{align*}
    \varphi \longmapsto \left( \phi \mapsto \int_{x\in\R} \varphi(x) \phi(x)\,dx \right)
  \end{align*}
  We hope that this map takes elements of \S into elements of $\S^*$, as we might expect it to.
  \begin{thm}
    The integration-against functional is continuous and linear.
    Thus, the mapping above gives an inclusion $\S\rightarrow\S^*$.
  \end{thm}
  \begin{proof}
    Linearity follows trivially from the definition.
    Thus we need only show that small inputs give small outputs, and continuity everywhere will follow from linearity.
    Fix some $\varphi\in\S$ and let $\{\phi_i\}$ be a sequence in \S approaching the zero function (which is trivially Schwartz).
    See that
    \begin{align*}
      |\langle\varphi,\phi_i\rangle| 
%      &= \left|\int_{x\in\R} \varphi(x)\phi_i(x)\,dx\right|
      &\le |\phi_i(x)|_\Coo \cdot \int_{x\in\R} |\varphi(x)|\,dx
%      \\&\le |\phi_i|_{C^k_\ell}\cdot\int_{x\in\R}|\varphi(x)|\,dx
    \end{align*}
    Because $\{\phi_i\}$ approaches zero in \S, $\{|\phi_i|_\Coo\}$ also approaches zero.
    Thus the sequence $\{\langle\varphi,\phi_i\rangle\}$ approaches zero in \C, so the functional is continuous.
  \end{proof}

  The continuity of the integration-against functional shows that each Schwartz function gives rise to a tempered distribution.
  In \cref{sec:tempdist} we saw that this inclusion allowed us to define the Fourier transform on \SS by the formula
  \begin{align*}
    \langle\F u, \varphi\rangle &= \langle u, \F\varphi\rangle
    \qquad u\in\SS, \varphi\in\S \text{.}
  \end{align*}
  
  We may define the derivative of a tempered distribution similarly.
  For Schwartz functions $f$ and $\varphi$, apply integration by parts and observe that because $f\varphi$ vanishes at infinity:
  \begin{align*}
    \langle f', \varphi\rangle
    &= -\int_{x\in\R} f(x)\varphi'(x)\,dx
    = -\langle f,\varphi'\rangle\text{.}
  \end{align*}
  \begin{defn}
    For a tempered distribution $u$, the distributional derivative of $u$ (denoted as usual by $u'$) is given by
    \begin{align*}
      \langle u', \varphi\rangle = -\langle u, \varphi'\rangle
      \qquad u\in\SS,\varphi\in\S \text{.}
    \end{align*}
    When $u$ is given by (integration against) a Schwartz function $f$, the distribution $u'$ is given by the derivative $f'\in\S$ by the calculation above. 
  \end{defn}
  
  As with the Fourier Transform, the definition of the distributional derivative extends good properties of \S to all of $\S^*$.
  It is immediately obvious that any tempered distribution has infinitely many derivatives which are all themselves tempered distributions.
  We might also expect that, as on $\S$, the differentiation map is continuous on $\S^*$, but this involves topology on $S^*$, which we have not yet developed.
  We thus give the space of tempered distributions the so-called ``initial topology'', which allows us to carry topology from a space to its dual.
  \begin{defn}
    Let $X^*$ be the continuous linear dual of a topological space $X$.
    The initial topology on $X^*$ with respect to its linear dual, also called the \emph{weak-* topology} is the coarsest topology ensuring that for all $\varphi\in X^*$ the evaluation functional
    \begin{gather*}
      u_\varphi: X^*\rightarrow\C, \qquad f\mapsto\langle\varphi,f\rangle
    \end{gather*}
    is continuous.
  \end{defn}

  \begin{claim}
    The differentiation map $D:\SS\rightarrow\SS$ is continuous under the \ws.
  \end{claim}
  \begin{proof}
    Consider a sequence of tempered distributions $\{u_i\}$ that converges to zero.
    By definition of the \ws, we have for any Schwartz function $\varphi$, the sequence $\{\langle u_i,\varphi\rangle\}$ converges to zero by continuity of the evaluation-at-$\varphi$ functional.
    Thus the sequence $ \{\langle Du_i, \varphi\rangle\} = \{-\langle u_i, \varphi'\rangle\} \rightarrow 0 $ and so $\{Du_i\}\rightarrow 0$ in the \ws.
  \end{proof}

  \section{Approximation by Schwartz Functions}
    A simple distribution is Dirac delta:
    \begin{gather*}
      \delta:\S\rightarrow\C\\
      \langle\delta,\varphi\rangle = \varphi(0)
    \end{gather*}
    Because $\delta$ is trivially linear, and continuous by \cref{thm:sevalcts}, $\delta\in\SS$.
    In fact, $\delta$ is not a classical function, and so is a ``true distribution'' in that it does not arise from a function with pointwise values.
    If $\delta$ were a classical function of any sort, we would have
    \begin{gather*}
      \delta(x)=0\text{ for }x\ne0\\
      \int_{x\in\R} \delta(x)\,dx = 1
    \end{gather*}
    but for any $z=\delta(0)\in\C$ the integral must be zero.
    However, $\delta$ may be approximated by Schwartz functions, in the sense that there is a sequence $\{\phi_n\}$ in \S so that for any $\varphi\in\S$
    \begin{align*}
      \langle \phi_n, \varphi\rangle \underset{n}{\longrightarrow} \varphi(0)\text{.}
    \end{align*}
    We call any sequence that satisfies this condition an \emph{approximate identity}.
    For an approximate identity $\{\phi_n\}$ we have that $\{\langle\phi_n,\varphi\rangle\}\rightarrow\langle\delta,\varphi\rangle$ for arbitrary $\varphi\in\S$, and so $\{\phi_n\}\rightarrow\delta$ in the \ws.

    \begin{thm}[Existence of Approximate Identities]
      There is a sequence $\{\phi_n\}$ in \S so that $\langle\lim_n \phi_n,\varphi\rangle = \varphi(0)$ for all $\varphi\in\S$.
    \end{thm}
    \begin{proof}
      Let $\phi$ be some non-negative Schwartz function having integral 1, so that for any $n\in\Z_{>0}$, the function $x\mapsto n\phi(nx) \call \phi_n$ is is a non-negative Schwartz function having integral 1.
      
      Given any $\delta,\varepsilon>0$ consider the quantity
      \begin{align*}
        \int_{|x|\ge\delta} \phi_n(x) \,dx
        &= \int_{|x|\ge n\delta} \phi(x) \,dx \text{.}
      \end{align*}
      Because $\phi$ is Schwartz, there is some $X$ so that $\int_{|x|\ge X}\phi(x)\,dx<\varepsilon$.
      Thus for $n>X/\delta$ we have 
      \begin{align*}
        \int_{|x|\ge\delta} \phi_n(x) \,dx
        &= \int_{|x|\ge n\delta} \phi(x) \,dx
        \le \int_{|x|\ge X} \phi(x) \,dx
        <\varepsilon \text{,}
      \end{align*}
      so for any $\delta,\varepsilon>0$ there is some $N$ so that $n>N$ implies $\int_{|x|\ge\delta}\phi_n(x)\,dx<\varepsilon$.
      Thus we also see that $\lim\limits_{n\rightarrow\infty} \int_{|x|<\delta}\phi_n(x)\,dx=1$.

      Now for any $\varphi\in\S$ consider the limit
      \begin{align*}
        \lim_{n\rightarrow\infty}\langle\phi_n,\varphi\rangle 
        &=\lim_{n\rightarrow\infty}\int_{x\in\R} \phi_n(x)\varphi(x)\,dx\text{.}
      \end{align*}
      We hope this converges to $\varphi(0)$.
      First, we bound error in the integral away from the origin.
      Fix some $\rho>0$ and let $\varepsilon$ be some small positive number.
      Write
      \begin{align*}
        \sup_{|x|\ge\rho} |\varphi(x)| = C_\rho \text{.}
      \end{align*}
      Pick $N$ so that for $n>N$
      \begin{align*}
        \int_{|x|\ge\rho} \phi_n(x)\,dx
        < \frac\varepsilon{C_\rho}
      \end{align*}
      and so
      \begin{align*}
        \int_{|x|\ge\rho} \phi_n(x)\varphi(x)\,dx
        &\le C_\rho \cdot \int_{|x|\ge\rho} \phi_n(x)\,dx
        < \varepsilon \text{,}
      \end{align*}
      showing that
      \begin{align*}
        \lim_{n\rightarrow\infty} \int_{|x|\ge\rho} \phi_n(x)\varphi(x)\,dx
        = 0 \text{.}
      \end{align*}

      It remains to show that the integral on $(-\rho,\rho)$ converges to the desired value.
      By the continuity of $\varphi$, there is some $\varepsilon_\rho$ so that $|x|<\rho$ implies $|\varphi(x)-\varphi(0)|<\varepsilon_\rho$, so
      \begin{align*}
        (\varphi(0)-\varepsilon_\rho)\cdot \int_{|x|<\rho} \phi_n(x)\,dx
        \le \int_{|x|<\rho} \phi_n(x)\varphi(x)\,dx
        \le (\varphi(0)+\varepsilon_\rho)\cdot \int_{|x|<\rho} \phi_n(x)\, dx
      \end{align*}
      Because $n$ and $\rho$ are independent of one another we may take the limits in any order, so we consider $n$ first.
      Taking the limit of the bounding terms as $n$ grows, the integrals approach 1, so we have
      \begin{align*}
        \left| \lim_{n\rightarrow\infty}\left(\int_{|x|<\rho} \phi_n(x)\varphi(x)\,dx\right) - \varphi(0) \right|
        < \varepsilon_\rho
      \end{align*}
      Thus by combining the previous displays see that 
      \begin{align*}
        \lim_{n\rightarrow\infty}\left| \int_{x\in\R} \phi_n(x)\varphi(x)\,dx -\varphi(0)\right|
        &\le \lim_{n\rightarrow\infty} \left( \left| \int_{|x|\ge\rho} \phi_n(x)\varphi(x)\,dx \right|
        + \left| \int_{|x|<\rho} \phi_n(x)\varphi(x)\,dx -\varphi(0)\right| \right)
        \\&< 0 + \varepsilon_\rho
      \end{align*}
      By the continuity of $\varphi$, $\varepsilon_\rho$ approaches zero as $\rho$ does.
      Because the left-hand quantity in the display does not depend on $\rho$, by taking small $\rho$ we see that $\int_\R \phi_n\varphi$ must be arbitrarily close to $\varphi(0)$.
      Thus $\{\phi_n\}$ is an approximate identity.
    \end{proof}

    The fact that approximate identities exist implies a much stronger result---that \emph{any} tempered distribution may be approximated by Schwartz functions in the \ws.
    To see this, we must first recall a method for ``smoothing'' functions.

    Recall from \cref{defn:convolution} that the convolution of two Schwartz functions $f$ and $g$ is a function given by
    \begin{align*}
      (f*g)(x) = \int_{y\in\R} f(x-y)g(y)\,dy \text{.}
    \end{align*}
    Because $f$ and $g$ are Schwartz, see that $f*g$ is a smooth function of $x$ because the $x$ derivative passes through the $y$ integral and attaches itself to the $f$ term.
    Furthermore, as $|x|$ grows, we have that for any $y\in\R$ at least one of $|x-y|$ or $|y|$ is large, and so either $f(x-y)$ or $g(y)$ will approach zero.
    Thus we see that $(f*g)(x)$ will vanish as $|x|\rightarrow\infty$.
    In fact, multiplying the convolution by some power of $x$ we get
    \begin{align*}
      x^\ell(f*g)(x)
      &= \int_{y\in\R} x^\ell f(x-y)g(y)\,dy \text{.}
    \end{align*}
    For any fixed $y$ the function $x^\ell f(x-y)$ will vanish at infinity because it is Schwartz, and so the integral vanishes at infinity, because as $x\rightarrow\infty$ the integrand converges pointwise to the zero function.
    Thus the convolution of two Schwartz functions is another Schwartz function, and so \S acts on itself by convolution.

    The action of \S on itself gives an action of \S on its embedded image in \SS.
    For some $f,g\in\S$, $f$ acts on the distribution $u_g$ arising from $g$ by
    \begin{align*}
      f*u_g = u_{f*g} \text{.}
    \end{align*}
    For any $\varphi\in\S$ we have
    \begin{align*}
      \langle f*u_g, \varphi\rangle
      &= \langle u_{f*g}, \varphi\rangle
%      \\&= \int_{x\in\R} (f*g)(x)\varphi(x)\,dx
      \\&= \int_{x\in\R} \int_{y\in\R} f(x-y)g(y)\,dy \varphi(x)\,dx
      \\&= \int_{y\in\R} g(y) \int_{x\in\R} f(x-y)\varphi(x)\,dx\,dy
      \\&= \langle u_g, \tilde f*\varphi\rangle
    \end{align*}
    where $\tilde f(x) = f(-x)$.
    As with the derivative, this formula allows us to extend our definition of convolution to allow one of the arguments to be a distribution.
    Define the action of a Schwartz function $\phi$ on a distribution $u$ by the adjoint identity
    \begin{align*}
      \langle \phi*u, \varphi\rangle
      = \langle u, \tilde\phi*\varphi\rangle \text{.}
    \end{align*}
    Notably, unlike the convolution of Schwartz functions, this action is asymmetric, as we may not convolve two distributions.
    Thus we refer to the distribution $\phi*u$ as the \emph{mollification} of $u$ by $\phi$.

    We might wonder if a mollification is in fact given by integration against some classical function.
    Again letting $f,g\in\S$, write
    \begin{align*}
      (f*g)(x)
      &= \int_{y\in\R} f(x-y)g(y)\,dy
%      \\&= \int_{y\in\R} T_{-x}\tilde f(y) g(y)\, dy
      = \langle g, T_{-x}\tilde f\rangle
    \end{align*}
    which suggests a sensible expression for pointwise values of the mollification even when $g\in\SS$.
    For $u\in\SS$ and $\phi\in\S$ we wonder if the function $\psi:\R\rightarrow
    C$ given by $\psi(x)=\langle u, T_{-x}\tilde \phi\rangle$ gives rise to the distribution $\phi*u$ defined above.
    Calculate for any $\varphi\in\S$
    \begin{align*}
      \left\langle \psi, \varphi \right\rangle
      &= \int_{x\in\R} \langle u,T_{-x}\tilde\phi\rangle\varphi(x)\,dx
      = \left\langle u, \int_{x\in\R} (T_{-x}\tilde\phi)\varphi(x)\,dx \right\rangle
%      \\&= \left\langle u, \int_{x\in\R} \tilde\phi(y-x)\varphi(x)\,dx \right\rangle
      = \langle u, \tilde\phi*\varphi\rangle
    \end{align*}
    with the second equality exchanging the order of integration.
    Thus $\phi*u$ is in fact a classical function with pointwise values given by $(\phi*u)(x)=\psi(x)=\langle u, T_{-x}\tilde\phi\rangle$.
    Because $f\mapsto\tilde f$ is continuous (null sequences map to null sequences), translation is continuous (\cref{claim:translcont}), and $u$ is continuous, see that the composition
    \begin{align*}
      x, \phi \mapsto x, \tilde\phi \mapsto T_{-x}\phi \mapsto \langle u, T_{-x}\phi \rangle
    \end{align*}
    is a continuous function of $x\in\R$.
    
    See that the derivative of $\phi*u$ at any $x\in\R$ is given by
    \begin{align*}
      \lim_{t\rightarrow0} \frac{\langle u, T_{-x+t}\phi\rangle - \langle u, T_{-x}\phi\rangle}{t}
      &= \lim_{t\rightarrow0} \frac{\langle u, T_{-x+t}\phi-T_{-x}\phi\rangle}{t}
      \\&= \left\langle u, \lim_{t\rightarrow0} \frac{T_{-x+t}\phi-T_{-x}\phi}{t}\right\rangle
      \\&= \left\langle u, T_{-x}\phi'\right\rangle
    \end{align*}
    and so $\phi*u$ is a smooth function because we may put all derivatives on the Schwartz function~$\phi$.

    \begin{thm}
      \label{thm:sdenseinss}
      The space of Schwartz functions is dense\footnotemark in the space of tempered distributions.
    \end{thm}
    \footnotetext{Recall that a subset $A$ of a topological space $X$ is called \emph{dense in $X$} if for any $x\in X$, every neighborhood of $x$ contains an element of $A$.}
    \begin{proof}
      Let $u\in\SS$.
      Let $\phi$ be a positive even Schwartz function with integral 1, so that for any $n$, the function $x\mapsto n\phi(nx) \call \phi_n$ has integral 1, so $\{\phi_n\}$ is an approximate identity.
      Thus the sequence of mollifications $\{\phi_n*u\}$ approximates $u$ in the \ws because for all $f\in\S$, 
      \begin{align*}
        \langle \phi_n*u, f\rangle
        &= \langle u, \phi_n*f\rangle
%        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(x-y)f(y)\,dy \right\rangle
%        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(-y)f(x+y)\,dy \right\rangle
%        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(y)T_xf(-y)\,dy \right\rangle
%        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(y)T_xf(y)\,dy \right\rangle
        \\&= \left\langle u, \langle f, T_{-x}\phi_n\rangle \right\rangle
        \\&= \left\langle u, \langle \phi_n, T_{x}f\rangle \right\rangle
        \\&\underset{n}{\longrightarrow} \left\langle u, T_xf(0) \right\rangle
        \\&= \langle u,f\rangle \text{.}
      \end{align*}

      Let $\{A_i\}$ be a sequence of positive real numbers that approaches infinity.
      Let $\psi_i$ be a Schwartz function that is identically 1 on $[-A_i,A_i]$ and identically zero outside $[-A_i-1,A_i+1]$.
      See that such $\psi_i$ exist because the function
      \begin{align*}
        h(x) &=
        \begin{cases}
          e^\frac{1}{x^2-1} &\text{if }|x|<1\\
          0 &\text{otherwise}
        \end{cases}
      \end{align*}
      is verifiable smooth at any $x\in\R$.
      The integral of $h$ 
      \begin{align*}
        \int_{-\infty}^x h(t)\,dt
      \end{align*}
      has value 0 for $x$ to the left of -1 and grows smoothly on $[-1,1]$ to a positive constant, which it takes for all $x>1$.
      Glueing this function to a translated and mirrored version of itself gives a ``mesa'' function, as shown in \cref{fig:mesafunc}.
      We may thus construct the $\psi_i$ through such a process.

      \begin{figure}[t]
        \begin{center}
          \begin{sagesilent}
            from matplotlib import ticker
            h = lambda x: e^(1/(x^2-1))
            g = Piecewise([[(.5,1), 0],[(1,2), h(x-2)/h(0)], [(2,5), 1], [(5,6), h(x-5)/h(0)], [(6,6.5), 0]])
            p = plot(g, color="black", plot_points=500, ticks=[[1, 2, 5, 6],[]], tick_formatter= ticker.FixedFormatter(['$-A_i-1$','$-A_i$','$A_i$','$A_i+1$']), figsize=[6,1])
          \end{sagesilent}
          \sageplot[width=\figwidth]{p}
        \end{center}
        \caption{A mesa function.}
        \label{fig:mesafunc}
      \end{figure}

      For any $i,n$ the function $x\mapsto\psi_i(x)(\phi_n*u)(x)$ is Schwartz because it is zero for $|x|>A_i+1$ and pointwise multiplication of functions does not affect smoothness.
      Clearly $\lim_{i\rightarrow\infty}\psi_i(x)(\phi_n*u)(x)=(\phi_n*u)(x)$, so the sequence $\{\psi_i(\phi_n*u)\}\rightarrow\phi_n*u$ in the \ws.

      Now pick a neighborhood $U$ of $u$ in \SS.
      Because the sequence $\{\phi_n*u\}\rightarrow u$ there is some $n$ so that $\phi_n*u\in U$.
      Then because the sequence $\{\psi_i(\phi_n*u)\}\rightarrow\phi_n*u$ there is some $i$ so that $\psi_i(\phi_n*u)\in U$.
      Each $\psi_j(\phi_n*u)$ is Schwartz, so because $u$ and $U$ were arbitrary, \S is dense in \SS.
    \end{proof}

\end{document}

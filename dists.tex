\input{chpreamble}
  \chapter{Distributions}
  \label{ch:dist}
  
  With a firm grasp of the topology of \S, we now turn back to topological issues.
  Recall from \cref{sec:tempdist} that continuous linear dual of \S is the space of \emph{tempered distributions}:
  \begin{align*}
    \S^* = \{f:\S\rightarrow\C\,\vert\,f\text{ is continuous and linear}\}
  \end{align*}
  This definition is now fully sensible, as we know what it means to be a continuous functional on \S.
  Recall the mapping taking a test function $\varphi$ to the integration-against-$\varphi$ functional on \S:
  \begin{align*}
    \varphi \longmapsto \left( \phi \mapsto \int_{x\in\R} \varphi(x) \phi(x)\,dx \right)
  \end{align*}
  We hope that this map takes elements of \S into elements of $\S^*$, as we might expect it to.
  \begin{thm}
    The integration-against functional is continuous and linear.
    Thus, the mapping above gives an inclusion $\S\rightarrow\S^*$.
  \end{thm}
  \begin{proof}
    Linearity follows trivially from the definition.
    Thus we need only show that small inputs give small outputs, and continuity everywhere will follow from linearity.
    Fix some $\varphi\in\S$ and let $\{\phi_i\}$ be a sequence in \S approaching the zero function (which is trivially Schwartz).
    See that
    \begin{align*}
      |\langle\varphi,\phi_i\rangle| 
%      &= \left|\int_{x\in\R} \varphi(x)\phi_i(x)\,dx\right|
      &\le \int_{x\in\R}| \varphi(x)\phi_i(x)|\,dx
      \\&\le |\phi_i|_{C^k_\ell}\cdot\int_{x\in\R}|\varphi(x)|\,dx
    \end{align*}
    for any $k$ and $\ell$, by definition of the $C^k_\ell$ norm.
    Because $\{\phi_i\}$ approaches zero in \S, we see that $\{|\phi_i|_{C^k_\ell}\}$ also approaches zero.
    Thus the sequence $\{\langle\varphi,\phi_i\rangle\}$ approaches zero in \C, so the functional is continuous.
  \end{proof}

  The continuity of the integration-against functional shows that each Schwartz function corresponds naturally to a tempered distribution.
  In \cref{sec:tempdist} we saw that this inclusion allowed us to define the Fourier transform for any $f\in\S^*$ by the formula
  \begin{align*}
    \langle\F f, \varphi\rangle &= \langle f, \F\varphi\rangle
  \end{align*}
  for $\varphi\in\S$.
  
  We may define the derivative of a tempered distribution similarly.
  For Schwartz functions $f$ and $\varphi$, apply integration by parts and observe that $f\varphi$ vanishes at infinity:
  \begin{align*}
    \langle f', \varphi\rangle
    &= [f(x)\varphi(x)]_{-\infty}^\infty -\int_{x\in\R} f(x)\varphi'(x)\,dx
    = -\langle f,\varphi'\rangle\text{.}
  \end{align*}
  \begin{defn}
    For a tempered distribution $u$, the distributional derivative of $u$ (denoted as usual by $u'$) is given by
    \begin{align*}
      \langle u', \varphi\rangle = -\langle u, \varphi'\rangle
    \end{align*}
    for any Schwartz function $\varphi$.
    When $u$ corresponds to a Schwartz function $f$, the distribution $u'$ visibly corresponds to the derivative $f'\in\S$ by the calculation above. 
  \end{defn}
  
  As with the Fourier Transform, the definition of the distributional derivative extends good properties of \S to all of $\S^*$.
  It is immediately obvious that any tempered distribution has infinitely many derivatives which are all themselves tempered distributions.
  We might also expect that, as on $\S$, the differentiation map is continuous on $\S^*$, but this involves topology on $S^*$, which we have not yet developed.
  We thus give the space of tempered distributions the so-called ``initial topology'', which allows us to carry topology from a space to its dual.
  \begin{defn}
    Let $X^*$ be the continuous linear dual of a topological space $X$.
    The initial topology on $X^*$ with respect to its linear dual, also called the \emph{weak-* topology} is the coarsest topology (the one with the fewest open sets) ensuring the continuity of the evaluation functionals
    \begin{gather*}
      X^*\longrightarrow\C\\
      u\mapsto \langle u,\varphi\rangle\qquad\text{for }\varphi\in X\text{.}
    \end{gather*}
  \end{defn}

  \begin{claim}
    The differentiation map $D:\SS\rightarrow\SS$ is continuous under the \ws.
  \end{claim}
  \begin{proof}
    Consider a sequence of tempered distributions $\{u_i\}$ that converges to zero.
    By definition of the \ws, we have for any Schwartz function $\varphi$, the sequence $\{\langle u_i,\varphi\rangle\}$ converges to zero by continuity of the evaluation-at-$\varphi$ functional.
    Thus the sequence $ \{\langle Du_i, \varphi\rangle\} = \{-\langle u_i, \varphi'\rangle\} \rightarrow 0 $ and so $\{Du_i\}\rightarrow 0$ in the \ws.
  \end{proof}

  \section{Approximation by Schwartz Functions}
    A simple distribution is Dirac delta:
    \begin{gather*}
      \delta:\S\rightarrow\C\\
      \langle\delta,\varphi\rangle = \varphi(0)
    \end{gather*}
    Because $\delta$ is trivially linear, and continuous by \cref{thm:sevalcts}, $\delta\in\SS$.
    In fact, $\delta$ is not a classical function, and so is a ``true distribution'' in that it does not arise from a function with pointwise values.
    If $\delta$ were a classical function of any sort, we would have
    \begin{gather*}
      \delta(x)=0\text{ for }x\ne0\\
      \int_{x\in\R} \delta(x)\,dx = 1
    \end{gather*}
    but for any $z=\delta(0)\in\C$ the integral must be zero.
    However, $\delta$ may be approximated by Schwartz functions, in the sense that there is a sequence $\{\phi_n\}$ in \S so that for any $\varphi\in\S$
    \begin{align*}
      \langle \phi_n, \varphi\rangle \underset{n}{\longrightarrow} \varphi(0)\text{.}
    \end{align*}
    Because \SS is complete in the \ws \todo{explain why}, there is some tempered distribution that is the limit of the sequence $\{\phi_n\}$.
    Thus by the continuity of evaluation at any $\varphi\in\S$, we may write $\langle\lim_n\phi_n,\varphi\rangle=\varphi(0)$, and so $\lim_n\phi_n=\delta$.

    \begin{thm}[Approximate Identity]
      There is a sequence $\{\phi_n\}$ in \S so that $\langle\lim_n \phi_n,\varphi\rangle = \varphi(0)$ for all $\varphi\in\S$.
    \end{thm}
    \begin{proof}
      Let $\phi$ be some non-negative Schwartz function with integral 1, so that for any $n\in\mathbb{N}_{>0}$, the function $x\mapsto n\phi(nx) \call \phi_n$ is Schwartz and has integral 1.
      For any $\varphi\in\S$ consider the limit
      \begin{align*}
        \lim_{n\rightarrow\infty}\langle\phi_n,\varphi\rangle 
        &=\lim_{n\rightarrow\infty}\int_{x\in\R} \phi_n(x)\varphi(x)\,dx\text{.}
      \end{align*}
      We hope this converges to $\varphi(0)$.
      First, we bound error in the integral away from the origin.
      Fix some $\rho>0$ and let $\varepsilon$ be some small positive number.
      Write
      \begin{align*}
        \sup_{|x|>\rho} |\varphi(x)| = C_\rho \text{.}
      \end{align*}
      As $n$ grows the integral $\int_{x\in\R}\phi_n(x)\,dx$ is constantly 1, so
      \begin{align*}
        \int_{|x|>\rho} \phi_n(x)\,dx
        = 1-n\cdot\int_{|x|\le n\rho} \phi(x)\,dx
        \le 1-\int_{|x|\le n\rho} \phi(x)\,dx
        \underset n\longrightarrow 0 \text{.}
      \end{align*}
      Use this convergence to pick $N$ so that for $n>N$
      \begin{align*}
        \int_{|x|>\rho} \phi_n(x)\,dx
        < \frac\varepsilon{C_\rho}
      \end{align*}
      and so
      \begin{align*}
        \int_{|x|>\rho} \phi_n(x)\varphi(x)\,dx
        &\le C_\rho \cdot \int_{|x|>\rho} \phi_n(x)\,dx
        < \varepsilon \text{,}
      \end{align*}
      showing that
      \begin{align*}
        \lim_{n\rightarrow\infty} \int_{|x|>\rho} \phi_n(x)\varphi(x)\,dx
        = 0 \text{.}
      \end{align*}

      It remains to show that the integral on $[-\rho,\rho]$ converges to the desired value.
      By the continuity of $\varphi$, there is some $\varepsilon_\rho$ so that $|x|\le\rho$ implies $|\varphi(x)-\varphi(0)|<\varepsilon_\rho$, so
      \begin{align*}
        (\varphi(0)-\varepsilon_\rho)\cdot \int_{|x|\le\rho} \phi_n(x)\,dx
        \le \int_{|x|\le\rho} \phi_n(x)\varphi(x)\,dx
        \le (\varphi(0)+\varepsilon_\rho)\cdot \int_{|x|\le\rho} \phi_n(x)\, dx
      \end{align*}
      Because $n$ and $\rho$ are independent of one another we may take the limits in any order, so we consider $n$ first.
      Taking the limit of the bounding terms as $n$ grows, the integrals approach 1, so
      \begin{align*}
        \left| \int_{|x|\le\rho} \phi_n(x)\varphi(x)\,dx - \varphi(0) \right|
        < \varepsilon_\rho
      \end{align*}
      As $\rho\rightarrow0$ the continuity of $\varphi$ forces $\varepsilon_\rho$ to zero, and so
      \begin{align*}
        \lim_{n\rightarrow\infty} \left| \int_{x\in\R} \phi_n(x)\varphi(x)\,dx - \varphi(0) \right|
        = \lim_{\rho\rightarrow 0} \varepsilon_\rho
        = 0 \text{.}
      \end{align*}
    \end{proof}

    The fact that approximate identities exist implies a much stronger result---that \emph{any} tempered distribution may be approximated by Schwartz functions in the \ws.

    \todo{introduce convolution on $\S^2$ (using \cref{defn:convolution}) before we use it here.}
    Recall that the convolution of two Schwartz functions $f$ and $g$ is a Schwartz function $f*g$ given by
    \begin{align*}
      (f*g)(x) = \int_{y\in\R} f(x-y)g(y)\,dy \text{.}
    \end{align*}
    Treating this function as a distribution, exchange order of integration and calculate
    \begin{align*}
      \langle f*g,\varphi\rangle
  %    &= \int_{x\in\R} (f*g)(x)\varphi(x)\,dx
      &= \int_{x\in\R} \varphi(x) \int_{y\in\R} f(x-y)g(y)\,dy\,dx
      \\&= \int_{y\in\R} g(y) \int_{x\in\R} f(x-y)\varphi(x)\,dx\,dy
      = \langle g, \tilde f*\varphi\rangle
    \end{align*}
    where $\tilde f(x) = f(-x)$.

    As with the derivative, this formula allows us to extend our definition of convolution to allow one of the arguments to be a distribution.
    Observing the role $g$ plays, define the action of a Schwartz function $\phi$ on a distribution $u$ by the adjoint identity
    \begin{align*}
      \langle \phi*u, \varphi\rangle
      = \langle u, \tilde\phi*\varphi\rangle \text{.}
    \end{align*}
    Notably, unlike the convolution of Schwartz functions, this action is assymetric, as we may not convolve two distributions.
    Thus we refer to the distribution $\phi*u$ as the \emph{mollification} of $u$ by $\phi$.
    We wonder if this distribution is in fact given by (integration against) some classical function.
    Again letting $f,g\in\S$, calculate
    \begin{align*}
      (f*g)(x)
      &= \int_{y\in\R} f(x-y)g(y)\,dy
      \\&= \int_{y\in\R} T_{-x}\tilde f(y) g(y)\, dy
      \\&= \langle g, T_{-x}\tilde f\rangle
    \end{align*}
    which suggests a sensible expression for pointwise values of the convolution even when $g\in\SS$.
    We hope that this expression is consistent with the adjoint definition above.
    For $u\in\SS$ and $\phi,\varphi\in\S$ calculate
    \begin{align*}
      \left\langle \langle u,T_{-x}\tilde\phi\rangle, \varphi \right\rangle
      &= \int_{x\in\R} \langle u,T_{-x}\tilde\phi\rangle\varphi(x)\,dx
      \\&= \left\langle u, \int_{x\in\R} (T_{-x}\tilde\phi)\varphi(x)\,dx \right\rangle
      \\&= \left\langle u, \int_{x\in\R} \tilde\phi(y-x)\varphi(x)\,dx \right\rangle
      \\&= \langle u, \tilde\phi*\varphi\rangle
    \end{align*}
    with the second equality exchanging the order of integration.
    Thus $\phi*u$ is in fact a classical function with pointwise values given by $(\phi*u)(x)=\langle u, T_{-x}\tilde\phi\rangle$.
    Because $f\mapsto\tilde f$ is continuous (null sequences map to null sequences), translation is continuous (\cref{claim:translcont}), and $u$ is continuous, see that the composition
    \begin{align*}
      x, \phi \mapsto x, \tilde\phi \mapsto T_{-x}\phi \mapsto \langle u, T_{-x}\phi \rangle
    \end{align*}
    is a continuous function of $x\in\R$.
    
    See that the derivative of $\phi*u$ at any $x\in\R$ is given by
    \begin{align*}
      \lim_{t\rightarrow0} \frac{\langle u, T_{-x+t}\phi\rangle - \langle u, T_{-x}\phi\rangle}{t}
      &= \lim_{t\rightarrow0} \frac{\langle u, T_{-x+t}\phi-T_{-x}\phi\rangle}{t}
      \\&= \left\langle u, \lim_{t\rightarrow0} \frac{T_{-x+t}\phi-T_{-x}\phi}{t}\right\rangle
      \\&= \left\langle u, T_{-x}\phi'\right\rangle
    \end{align*}
    and so $\phi*u$ is a smooth function because we may put all derivatives on the Schwartz function~$\phi$.
    \todo{justify passing limit into $\langle\cdot,\cdot\rangle$.}

%    \begin{claim}
%      Convolution $*:\S{\times}\SS \rightarrow \S$ is jointly continuous.
%      \begin{align*}
%      \end{align*}
%    \end{claim}
%    \begin{proof}
%      
%    \end{proof}

    \begin{thm}
      \label{thm:sdenseinss}
      The space of Schwartz functions is dense\footnotemark in the space of tempered distributions.
    \end{thm}
    \footnotetext{Recall that a subset $A$ of a topological space $X$ is called \emph{dense in $X$} if for any $x\in X$, every neighborhood of $x$ contains an element of $A$.}
    \begin{proof}
      Let $u\in\SS$.
      Let $\phi$ be a positive even Schwartz function with integral 1, so that for any $n$, the function $x\mapsto n\phi(nx) \call \phi_n$ has integral 1, so $\{\phi_n\}$ is an approximate identity.
      Thus the sequence of mollifications $\{\phi_n*u\}$ approximates $u$ in the \ws because for all $f\in\S$, 
      \begin{align*}
        \langle \phi_n*u, f\rangle
        &= \langle u, \phi_n*f\rangle
        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(x-y)f(y)\,dy \right\rangle
        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(y)f(x-y)\,dy \right\rangle
        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(y)T_xf(-y)\,dy \right\rangle
        \\&= \left\langle u, x\mapsto \int_{y\in\R} \phi_n(y)T_xf(y)\,dy \right\rangle
        \\&\underset{n}{\longrightarrow} \left\langle u, x\mapsto T_xf(0) \right\rangle
        \\&= \left\langle u, x\mapsto f(x) \right\rangle
        \\&= \langle u,f\rangle \text{.}
      \end{align*}

      Let $\{A_i\}$ be a sequence of positive real numbers that approaches infinity.
      Let $\psi_i$ be a Schwartz function that is identically 1 on $[-A_i,A_i]$ and identically zero outside $[-A_i-1,A_i+1]$.
      \todo{argue such fcns exist.}
      Then for any $i,n$ the function $x\mapsto\psi_i(x)(\phi_n*u)(x)$ is Schwartz because pointwise multiplication of functions does not affect smoothness or decay. \todo{argue this better.}
      Clearly $\lim_{i\rightarrow\infty}\psi_i(x)(\phi_n*u)(x)=(\phi_n*u)(x)$, so the sequence $\{\psi_i(\phi_n*u)\}\rightarrow\phi_n*u$ in the \ws.

      Now pick a neighborhood $U$ of $u$ in \SS.
      Because the sequence $\{\phi_n*u\}\rightarrow u$ there is some $n$ so that $\phi_n*u\in U$.
      Then because the sequence $\{\psi_i(\phi_n*u)\}\rightarrow\phi_n*u$ there is some $i$ so that $\psi_i(\phi_n*u)\in U$.
      Each $\psi_j(\phi_n*u)$ is Schwartz, so because $u$ and $U$ were arbitrary, \S is dense in \SS.
    \end{proof}

\end{document}
